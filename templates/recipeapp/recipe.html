{% extends "inner-page.html" %}

{% load static %}
{% block content %}

<style>

    .about .content ul li {
      position: relative;
      padding-left: 26px;
    }
    .page-review{
        display: flex;
        position: relative;
        justify-content: center;
        padding: 50px;
        }
    .page-review > a{
        color: black;
        text-align: center;
        margin: 0 5px;
        }

</style>
    <!-- ======= Breadcrumbs Section ======= -->
    <section class="breadcrumbs">
      <div class="container">

        <div class="d-flex justify-content-between align-items-center">
          <h2>Recipe Page</h2>
          <ol>
            <li><a href="{% url 'main' %}">Home</a></li>
            <li>Recipe Page</li>
          </ol>
        </div>

      </div>
    </section><!-- End Breadcrumbs Section -->

    <script>
         $(document).ready(function(){




            // ì–˜ë¥¼ í´ë¦­í–ˆì„ ë•Œ
            $('a[name="fav_add"]').click(function(){
                //ë ˆì‹œí”¼ ì•„ì´ë””
                 r_id = $(this).find('p')[1];
                 alert(r_id);
                // ì¦ì°¾ì¶”ê°€
                $.ajax({
                   url:{% url 'fav_add' %},
                   data:{'r_id':r_id},
                   type:'get',
                   success:function(data){
                        alert(data);
                        if(data.trim() == 'ok'){
                          $('span[name="fav_add"]').text('ğŸ’—');
                        }else{};
                   }
                });
            });


             // ì–˜ë¥¼ í´ë¦­í–ˆì„ ë•Œ
            $('a[name="fav_cancel"]').click(function(){
                //ë ˆì‹œí”¼ ì•„ì´ë””
                 r_id = $(this).find('p');
                // ì¦ì°¾ì·¨ì†Œ
                $.ajax({
                   url:{% url 'fav_cancel' %},
                   data:{'r_id':r_id},
                   type:'get',
                   success:function(data){
                        alert(data);
                        if(data.trim() == '1'){
                            $('span[name="fav_cancel"]').text('ğŸ¤');
                        }else{};
                   }
                });
            });
            // ì–˜ë¥¼ í´ë¦­í–ˆì„ ë•Œ
            $('button[name="search"]').click(function(){
                i_name = $('input[name="i_name"]').val();
                i_name_2="#"+i_name;
                location.href = i_name_2;
                document.getElementById(i_name).style.color='#ff2727';
            });
        });
    </script>

<!--============================ë‚´ê°€ ê°€ì§„ ì‹ì¬ë£Œ==================================================-->
    <!-- ======= Menu Section ======= -->
    <section style="background-color:#fffaf3; padding:30px 0px 0px 0px;" id="menu" class="menu">
      <div class="container">
    <!--  ë§Œì•½ ì„¸ì…˜ì˜ snickname ë¼ëŠ” keyì— valueê°€ ì¡´ì¬í•˜ë©´, ì¦‰, ë¡œê·¸ì¸ì´ ë˜ì–´ìˆìœ¼ë©´-->
    <!--  ë¡œê·¸ì¸ì´ ë˜ì–´ìˆëŠ” ê²½ìš°ì—ë§Œ ì„¸ì…˜ì— ê°’ë“¤ì´ ì €ì¥ë˜ì–´ìˆê²Œ í•´ë†“ì•˜ìŒ -->
          {% if request.session.snickname %}
            <div class="section-title">
    <!--      request.session.snickname : í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ë‹‰ë„¤ì„-->
              <h2>{{request.session.snickname}}ë‹˜ì´ ê°€ì§„ <span>ì‹ì¬ë£Œ ê³ ë¥´ê¸°</span></h2>
            </div>
    <!--  ë§Œì•½ ì„¸ì…˜ì˜ snickname ë¼ëŠ” keyì— valueê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´, ì¦‰, ë¡œê·¸ì¸ì´ ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´-->
          {% else %}
            <div class="section-title">
                <h2><span>ì‹ì¬ë£Œ ê³ ë¥´ê¸°</span></h2>
            </div>
          {% endif %}
          <div style="margin:0px 0px 0px 830px;">
            <div style="display:inline-block;" class="search">
                <input type="text" placeholder="ì‹ì¬ë£Œ ê²€ìƒ‰" list ="i_name" name="i_name">
                  <datalist id="i_name" name="i_name">
                  {% for ingr in ingredients %}
                    <option value="{{ingr.i_name}}">
                  {% endfor %}
                    </option>
                  </datalist>
            </div>
            <div style="display:inline-block;" class="button">
                <button name="search" style="padding:0px 12px 0px 12px;  height:34px;font-size:15px;color:white;text-align: center;background: #ffb03b;border: solid 2px white;border-radius: 25px;">ê²€ìƒ‰</button>
            </div>
          </div>
          <form action="{% url 'filtering' %}" method="post">
                {% csrf_token %}
                <div style="white-space:nowrap;overflow:auto;height:300px;" class="row">
                    {% for ui in ingredients %}
                      <div class="col-lg-2 menu-item">
                        <div class="menu-content">
                         <a id="{{ui.i_name}}" style="background-color:#fffaf3;">
                              {% if ingr_checked %}
                                {% if ui.i_name in ingr_checked %}
                                     <input type='checkbox' checked="checked" name='ingrcheck[]' value={{ui.i_id}}>&nbsp;&nbsp;<span style="background-color:#fffaf3;" name="{{ui.i_name}}">{{ui.i_name}}</span></input>
                                {% else %}
                                     <input type='checkbox' name='ingrcheck[]' value={{ui.i_id}}>&nbsp;&nbsp;<span style="background-color:#fffaf3;" name="{{ui.i_name}}">{{ui.i_name}}</span></input>
                                {% endif %}
                              {% else %}
                                     <input type='checkbox' name='ingrcheck[]' value={{ui.i_id}}>&nbsp;&nbsp;<span style="background-color:#fffaf3;" name="{{ui.i_name}}">{{ui.i_name}}</span></input>
                              {% endif %}
                         </a>
            <!--              ì²´í¬ë°•ìŠ¤ ì²´í¬ëœê±°:<input type='checkbox' name='ì„œë²„ì—ì„œ ì¸ì‹í•  ê°’' value='ì„œë²„ì— ì „ì†¡í•  ê°’' checked/>  -->
                        </div>
                        <div class="menu-ingredients">
                            {{ui.icp_name}} > {{ui.ic_name}}
                        </div>
                      </div>
                    {% endfor %}
                </div>

                <nav class="nav-menu d-none d-lg-block" >
                      <ul>
                        <li class="book-a-table text-center"><button style="margin:40px 0px 0px 481px;border:white; outline:0;" type="submit">ë ˆì‹œí”¼ ì¶”ì²œë°›ê¸°</button></li>
                      </ul>
                </nav>
          </form>
          <br><br><br><br>

      </div><br>
    </section><!-- End Menu Section -->

<!--==================================ë ˆì‹œí”¼ ëª©ë¡=====================================================-->
    <!-- ======= Gallery Section ======= -->
    <section id="gallery" class="gallery">
      <div class="container-fluid">

        <div class="section-title">
          <h2>ë ˆì‹œí”¼ <span>ëª©ë¡</span></h2>
          <p>Recipe list</p>
        </div>
        <div class="row no-gutters">

<!--    ë”± ì´ ë¶€ë¶„ë§Œ forë¬¸ ëŒë ¤ì„œ í•œê°œì˜ ì˜ì—­ ì•ˆì— í•œê°œì˜ ë ˆì‹œí”¼ì— ëŒ€í•œ ì •ë³´ê°€ ì¶œë ¥ë˜ê²Œë” í•´ì•¼ë¨ -->
        {% for r in recipes %}
          <div class="col-lg-3 col-md-4">
            <div class="gallery-item">
<!--            ì›ë˜ ì´ë ‡ê²Œ ë˜ì–´ìˆë˜ ì½”ë“œë¥¼-->
<!--            <a href="assets/img/gallery/gallery-1.jpg" class="venobox" data-gall="gallery-item">-->
<!--            ì´ë ‡ê²Œ ë°”ê¿”ì¤˜ì„œ ìŒì‹ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìŒì‹ì˜ detail í˜ì´ì§€ë¡œ ë„˜ì–´ê°€ê²Œë” í•´ë†“ìŒ(ì•„ì§ì€ ì—ëŸ¬ë‚¨)-->
                <a href="{% url 'recipe_detail' %}?r_id={{ r.r_id }}">
<!--                <h1>ì´ë¯¸ì§€{{r.r_image1}}</h1>-->
<!--             ì´ ë¶€ë¶„ì— ì›ë˜ ë“¤ì–´ê°€ ìˆë˜ ê¸°ë³¸ì‚¬ì§„ ëŒ€ì‹  ë ˆì‹œí”¼ í…Œì´ë¸”ì˜ r_image1 ê°’ì„ ê°€ì ¸ì™€ì„œ static/img í´ë” ì•ˆì— ìˆëŠ” ê°™ì€ ì´ë¦„ì˜ ì‚¬ì§„ íŒŒì¼ì„ ì¶œë ¥í•˜ë„ë¡ í•´ë†“ì€ ë¶€ë¶„-->
                <div style="height:258px"><img style="width:370px;height:260px;" src="{{r.r_mimage}}" alt="" class="img-fluid"></div>
                <br></br>
                </a>

                {% if r.r_id in favorite %}
                    <a href="" name='fav_cancel' style="margin:0px 0px -4px 0px; font-size:21px; ">ğŸ’—<p style="display:none;">{{r.r_id}}</p></a href="">
                {% else %}
                    <a href="" name='fav_add' style="margin:0px 0px -4px 0px; font-size:21px; ">ğŸ¤<p style="display:none;">{{r.r_id}}</p></a>
                {% endif %}


                <a href="{% url 'recipe_detail' %}?r_id={{ r.r_id }}"><span style="margin:30px 0px 0px 0px; font-size:21px; color:#000000;">{{r.r_name}} </span></a>
                <br>

                {% if r.r_num == 10.0 %}
                    <img src="static/img/star5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 9.0 %}
                    <img src="static/img/star4.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 8.0 %}
                    <img src="static/img/star4.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 7.0 %}
                    <img src="static/img/star3.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 6.0 %}
                    <img src="static/img/star3.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 5.0 %}
                    <img src="static/img/star2.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 4.0 %}
                    <img src="static/img/star2.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 3.0 %}
                    <img src="static/img/star1.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 2.0 %}
                    <img src="static/img/star1.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% elif r.r_num > 1.0 %}
                    <img src="static/img/star0.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% else %}
                    <img src="static/img/star0.5.jpg"><span style="font-size:15px; margin:0px 0px -4px 10px; color:#5f5950;">({{r.re_count}})</span>
                {% endif %}

                <p style="margin:4px 0px 0px 0px; font-size:17px; color:#5f5950;">ì‘ì„±ì : {{r.u_id}}</p>
                <p style="font-size:17px; margin:-1px 0px 10px 0px; color:#5f5950;">ì¡°íšŒìˆ˜ : {{r.r_view}} ì¶”ì²œìˆ˜ : {{r.r_recommend}}</p>

            </div>
          </div>
        {% endfor %}

        </div>




      </div>
    </section><!-- End Gallery Section -->



    {% if filtered == 'True' %}
                  <div style="background-color:#fffaf3; margin:40px 0px 0px 0px; padding:20px 0px 20px 0px;" class="container-fluid">
                    <li class="page-review">
                        {% if before %}
                        <a class="page-link" href="?&page_r={{beforenum}}&filtered=True">ì´ì „</a>
                        {% endif %}
                        {% for l in pagelist %}
                        <a class="page-link" href="?&page_r={{l}}&filtered=True">{{l}}</a>
                        {% endfor %}
                        {% if next %}
                        <a class="page-link" href="?&page_r={{nextnum}}&filtered=True">ë‹¤ìŒ</a>
                        {% endif %}
                    </li>
                  </div>
    {% else %}
                 <div style="background-color:#fffaf3; margin:40px 0px 0px 0px; padding:20px 0px 20px 0px;" class="container-fluid">
                    <li class="page-review">
                        {% if before %}
                            <a class="page-link" href="?&page_r={{beforenum}}&filtered=False">ì´ì „</a>
                        {% endif %}
                        {% for l in pagelist %}
                            <a class="page-link" href="?&page_r={{l}}&filtered=False">{{l}}</a>
                        {% endfor %}
                        {% if next %}
                            <a class="page-link" href="?&page_r={{nextnum}}&filtered=False">ë‹¤ìŒ</a>
                        {% endif %}
                    </li>
                  </div>

    {% endif %}




{% endblock %}

